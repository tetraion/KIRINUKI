目的
ひろゆきの動画の切り抜きに、字幕とライブチャットを重ねて見やすくする。


ステップ0｜準備（手入力をそろえる）

説明：後続処理に必要な基本情報を用意する。

入力（例）

切り抜き済み・16:9の .webm（KirinukiDBで取得／フォルダに保存）

動画URL（テンプレテキストに記述）

切り抜き区間の START（必須）と END（推奨） … hh:mm:ss でテンプレに記述

出力：処理に使う3点セット（webm / URL / START, END）

ステップ1｜既存字幕の有無チェック → 取得

説明：YouTubeに日本語の公開/自動字幕があるかを確認し、あれば取得（最優先）。

入力：動画URL

出力：subs_full.srt（ある場合）／「字幕なし」のメモ（無い場合）

ステップ2｜字幕の時間合わせ（リベース）

説明：取得した字幕を切り抜きの0秒起点に合わせる。START だけで基準合わせ、END があれば範囲外行を削除。

入力：subs_full.srt、START（必須）、END（任意だが推奨）

出力：subs_clip.srt

ステップ3｜ライブチャット（リプレイ）取得

説明：配信にチャット・リプレイがある場合、全量をJSONで取得（URLだけで可）。

入力：動画URL

出力：chat_full.json（ある場合）／「リプレイなし」のメモ（無い場合）

ステップ4｜チャットの区間抽出・整形

説明：チャットをSTART〜ENDで抽出し、切り抜き0秒基準に合わせる。必要なら匿名化・NGワード除去。

入力：chat_full.json、START（必須）、END（推奨）

出力：chat_clip.json

ステップ5｜チャット表示用オーバーレイ生成

説明：コメントだけを読みやすく出すためのASS（字幕）オーバーレイを作成（右カラム表示など、自作デザイン）。

入力：chat_clip.json

出力：chat_overlay.ass

ステップ6｜合成（字幕＋チャットを重ねる）

説明：既存の切り抜き .webm に、本文字幕（SRT）とチャット（ASS）を重ねて書き出す（再エンコードあり）。

入力：切り抜き済み .webm、subs_clip.srt、chat_overlay.ass

出力：final.mp4（完成品。拡張子は運用に合わせて.webmでも可）

ステップ7｜簡易チェック

説明：数十秒で最終確認（開始/終了のズレ、字幕の読みやすさ、チャットの重なり、音量など）。

入力：final.mp4

出力：OK または修正点メモ